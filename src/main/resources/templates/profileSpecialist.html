<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="en">

<head>
    <title>Profile</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600"/>
    <link rel="stylesheet" href="css/all.min.css"/>
    <link rel="stylesheet" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" href="css/templatemo-style.css"/>
    <link rel="icon" th:href="@{/images/logo.png}" type="image/x-icon"/>
</head>
<body>

<div class="container-fluid">
    <div class="row tm-brand-row">
        <div class="col-lg-4 col-10">
            <div class="tm-brand-container">
                <div class="tm-brand-texts">
                    <h1 class="text-uppercase tm-brand-name">TeleRehab</h1>
                </div>
            </div>
        </div>
        <div class="col-lg-8 col-2 tm-nav-col">
            <div class="tm-nav">
                <nav class="navbar navbar-expand-lg navbar-light tm-navbar">
                    <button
                            class="navbar-toggler"
                            type="button"
                            data-toggle="collapse"
                            data-target="#navbarNav"
                            aria-controls="navbarNav"
                            aria-expanded="false"
                            aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ml-auto mr-0">
                            <li class="nav-item active">
                                <div class="tm-nav-link-highlight"></div>
                                <a class="nav-link" href="#"
                                >Profile <span
                                        class="sr-only">(current)</span> </a
                                >
                            </li>
                            <li class="nav-item">
                                <div class="tm-nav-link-highlight"></div>
                                <a class="nav-link" th:href="@{/aboutSpecialist}"
                                >About </a
                                >
                            </li>
                            <li class="nav-item">
                                <div class="tm-nav-link-highlight"></div>
                                <div class="nav-link" sec:authorize="isAuthenticated()">
                                    <form id="logoutForm" method="POST" th:action="@{/logout}">
                                        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
                                    </form>
                                    <span sec:authentication="name"></span><a
                                        onclick="document.forms['logoutForm'].submit()">Logout</a>

                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="row tm-welcome-row">
    <div class="col-12">
        <div
                class="tm-welcome-parallax tm-center-child"
                data-parallax="scroll"
                data-image-src="images/doc.jpg"
        >
            <div class="tm-bg-black-transparent tm-parallax-overlay">
                <div sec:authorize="isAuthenticated()"></div>
                <h2>Hi [[${currentSpecialist.getName()}]]!</h2>
                <p>Welcome to your profile</p>
            </div>
        </div>
    </div>
</div>

<section class="row tm-pt-4">
    <div class="col-12 tm-page-cols-container">
        <div class="tm-page-col-left">

            <ul th:each="p : ${patients}" class="tabs clearfix filters-button-group">

                <li>
                    <a th:href="@{/{username}(username=${p.getUserName()})}" class="active">
                        <div class="tm-tab-icon"></div>
                        [[${p.getName()}]] [[${p.getSurname()}]]
                    </a>
                </li>

            </ul>

            <div class="row form-group"></div>
            <div class="container">
                <!--/*@thymesVar id="error" type=""*/-->
                <div class="alert alert-danger alert-dismissible" onclose="" role="alert" th:text="${error}"
                     th:if="${error}"></div>
                <div class="alert alert-success alert-dismissible" onclose="" role="alert" th:text="${success}"
                     th:if="${success}"></div>
            </div>
            <div class="row form-group"></div>

            <form th:action="@{/findPatient}" th:method="GET">
                <div class="container-fluid">
                    <div class=raw>
                        <fieldset>
                            <legend>Search for a new patient</legend>
                            <div class="form-group">
                                <input required type="text" name="username" class="form-control"
                                       placeholder="Username">
                            </div>
                            <div class="row form-group"></div>

                            <button type="submit" value="log in" class="btn btn-info">Add</button>
                        </fieldset>
                    </div>
                </div>
            </form>

        </div>

        <div class="row form-group"></div>

        <div class="tm-page-col-right" th:if="${patientClicked}!=null">
            <table class="table table-hover">
                <thead>
                <tr class="table-info">
                    <th scope="col">Name and surname</th>
                    <th>[[${patientClicked.getName()}]] [[${patientClicked.getSurname()}]]</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="col">Username</th>
                    <th th:text="${patientClicked.getUserName()}"></th>
                </tr>
                <tr>
                    <th scope="col">Phone number</th>
                    <th th:text="${patientClicked.getPhoneNumber()}"></th>
                </tr>
                <tr>
                    <th scope="col">E-mail</th>
                    <th th:text="${patientClicked.getEmail()}"></th>

                </tr>
                <tr>
                    <th scope="col">Audio/video chat</th>
                    <th><a th:href="@{/call}">
                        <button value="call" class="btn btn-info">
                            Call now
                        </button>
                    </a>
                    </th>
                </tr>
                <tr>
                    <th scope="col">History of trainings</th>
                    <th th:text="${patientClicked.getTrainingDates()}"></th>

                </tr>
                <tr>
                    <th scope="col">Recommended frequency</th>
                    <th th:text="${patientClicked.getFrequency()}"></th>
                </tr>
                <tr>

                    <th scope="col">Change frequency</th>
                    <th>
                        <form class="form-inline" th:align="center" th:action="@{/updateFrequency}">
                            <div class="container-fluid" align="center">
                                <div class=raw>
                                    <fieldset>
                                        <div class="form-group">
                                            <select th:name="frequencyChosen" class="form-control" id="exampleSelect3">
                                                <option th:each="f : ${frequencyList}" th:text="${f}"></option>
                                            </select>
                                            <div class="form-group">
                                                <input type="hidden" th:name="username"
                                                       th:value="${patientClicked.getUserName()}"/>
                                            </div>
                                            <button type="submit" value="submit1" class="btn btn-info">Set
                                            </button>
                                        </div>

                                    </fieldset>
                                </div>
                            </div>
                        </form>
                    </th>
                </tr>
                <tr>
                    <th scope="col">Results notes</th>
                    <th th:text="${patientClicked.getResultsDescription()}"></th>
                </tr>
                <tr>
                    <th scope="col">Change results notes</th>
                    <th>
                        <form th:action="@{/opinion}" th:method="GET">

                            <div class="container-fluid">
                                <div class=raw>
                                    <fieldset>
                                        <div class="form-group">
                                            <textarea
                                                    rows="10"
                                                    id="opinion"
                                                    th:name="opinion"
                                                    class="form-control rounded-0"
                                                    placeholder="Your Message"
                                                    required=""></textarea>
                                        </div>
                                        <div class="form-group">
                                            <input type="hidden" th:name="username"
                                                   th:value="${patientClicked.getUserName()}"/>
                                        </div>
                                        <button type="submit" value="log in" class="btn btn-info">Set</button>
                                    </fieldset>
                                </div>
                            </div>
                        </form>
                    </th>
                </tr>

                <tr>
                    <th scope="col">Current training plan</th>

                </tr>
                </tbody>
            </table>

            <ul th:each="e : ${exercises}">
                <li>
                    <strong th:text="${e.getName()}"></strong><br>
                    <img th:src="${e.getVisualRepresentation()}" alt="photo" th:width="700">
                </li>

                <form th:action="@{/deleteExercise/{exerciseName}(exerciseName=${e.getName()})}">
                    <div class="form-group">
                        <input type="hidden" th:name="username"
                               th:value="${patientClicked.getUserName()}"/>
                    </div>
                    <button type="submit" value="delete exercise" class="btn btn-danger"
                            onClick="return confirm('Are you sure you want to delete this exercise?')">Delete
                    </button>
                </form>
                <div class="row form-group"></div>
            </ul>

            <div class="row form-group"></div>
            <form th:align="center" th:action="@{/addNewExercise}">
                <div class="container-fluid" align="center">
                    <div class=raw>
                        <fieldset>
                            <div class="form-group">
                                <select th:name="exerciseChosen" class="form-control" id="exampleSelect2">
                                    <option th:each="e : ${exerciseList}" th:text="${e.getName()}"></option>
                                </select>
                            </div>
                            <div class="form-group">
                                <input type="hidden" th:name="username"
                                       th:value="${patientClicked.getUserName()}"/>
                            </div>
                            <button type="submit" value="submit1" class="btn btn-info">Add an exercise</button>
                        </fieldset>
                    </div>
                </div>
            </form>

        </div>

    </div>

</section>


<div class="row form-group"></div>


<div class="row form-group"></div>
<div class="row form-group"></div>
<footer class="contact">
    <div class="container-fluid">
        <img src="images/logo.png" alt="logo" th:width="45" th:height="45">
        <address class="contact-info">TELEREHAB
            telerehab@app.com.pl
        </address>
    </div>
</footer>
<div class="row form-group"></div>

<script src="js/jquery.min.js"></script>
<script src="js/parallax.min.js"></script>
<script src="js/bootstrap.min.js"></script>
</body>
</html>